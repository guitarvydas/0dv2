
OdinProcSignature {
  program = item+
  item =
    | proc -- proc
    | anyToken -- other
    
  proc = procSignature procDefinitionBody

  procDefinitionBody = "{" ws bodyStuff "}" ws

  procSignature =
    | id ws "::" ws pragma? "‚ù≤proc‚ù≥" ws odinParameterList odinReturnTypeList -- nonvoid
    | id ws "::" ws pragma? "‚ù≤proc‚ù≥" ws odinParameterList &procDefinitionBody -- void

  odinParameterList =
    | "(" ws ")" ws -- empty
    | "(" ws lastParameter ")" ws -- single
    | "(" ws notLastParameter+ lastParameter ")" ws -- multiple

  odinReturnType =
    | &procDefinitionBody -- void
    | "->" ws odinReturnTypeList -- typed
  odinReturnTypeList =
    |  "(" ws ")" ws -- empty
    |  "(" ws lastParameter ")" ws -- singlebracketed
    |  "(" ws notLastReturnParameter+ lastReturnParameter ")" ws -- multiple
    | ~"(" singleReturnParameter -- single

  notLastParameter = allocatorOrParameterName anythingButComma "," ws ~")"
  lastParameter = allocatorOrParameterName ~anythingButComma anythingButRPar

  notLastReturnParameter = parameterName? anythingButComma "," ws ~")"
  lastReturnParameter = parameterName? ~anythingButComma anythingButRPar
  singleReturnParameter = ~procDefinitionBody anythingButProcDefinitionBody

  pragma = "#‚ù≤force_inline‚ù≥" ws

  parameterName =
    | id ws &"," -- sharedtype
    | id ws ":" ws -- named
  allocator =  "‚ù≤allocator‚ù≥" ws ":=" ws
  allocatorOrParameterName = allocator | parameterName

  bodyStuff = skipTo<"}",proc>
  anythingButComma = skipTo<",",proc>
  anythingButRPar = skipTo<")",proc>
  anythingButProcDefinitionBody = skipTo<procDefinitionBody,proc>

      dqb = "‚Äú"
    dqe = "‚Äù"
  string = dqb (~dqb ~dqe any)* dqe

    sqb = "‚ùõ"
    sqe = "‚ùú"
  charconst = sqb (~sqb ~sqe any)* sqe

  id = "‚ù≤" (~"‚ù≤" ~"‚ù≥" any)* "‚ù≥"


    intb = "‚ü®"
    inte = "‚ü©"
  integer = intb (~intb ~inte any)* inte

    symb = "‚ù≤"
    syme = "‚ù≥"
  symbol = symb (~symb ~syme any)* syme
  sym<text> = symb text syme
    
    kwb = "‚Äπ"
    kwe = "‚Ä∫"
  keyword = kwb (~kwb ~kwe any)* kwe

    mcb = "‚ü™"
    mce = "‚ü´"
  multi_char_operator = mcb (~mcb ~mce any)* mce

  indentc = "‚á¢"
  dedentc = "‚á†"

    vb = "‚ù™"
    ve = "‚ù´"
    verbatim = vb (~vb ~ve any)* ve

  comment = "‚é£" (~"‚é£" ~"‚é¶" any)* "‚é¶"

    ab = "‚é®"
    ae = "‚é¨"
  annotation = ab (~ab ~ae any)* ae


  anyToken1 = string | charconst | id | integer | keyword | multi_char_operator | indentc | dedentc | verbatim | comment | symbol | integer | any
  anyToken = anyToken1

    uspc = "„Éª"
    unl = "‚¶ö"
    srcnl = unl
    
    spc = " "
    nl = "\n"

    commentspace = "‚ó¶"
    commentnl = "¬∂"

    stringspace = "‚ñ°"
    stringnl = "‚Ä°"
    charspace = "‚òê"
    charnl = "‚Ä†"

    scopebegin = "‚éß"
    scopeend = "‚é≠"

    semanticscopebeginopen = "‚ù™‚éß"
    semanticscopebeginclose = "‚ù´"
    semanticscopeendopen = "‚ù™‚é≠"
    semanticscopeendclose = "‚ù´"
    scopedvaropen = "‚ù™ùõï"
    scopedvarclose = "‚ù´"
    

    wsc = space | spc | nl | uspc | unl | indentc | dedentc | commentspace | commentnl | stringspace | stringnl | charspace | charnl | verbatim | scopebegin | scopeend
    ws = wsc*



    skipTo<stopBefore,macro> =
    | &stopBefore -- done
    | macro -- macro
    | inner skipTo<stopBefore,macro> -- continue
  inner =
    | "(" ws inner* ")" -- nestedparens
    | "{" ws inner* "}" -- nestedbraces
    | ~"(" ~")" ~"{" ~"}" ~scopebegin ~scopeend anyToken -- bottom
  
}

